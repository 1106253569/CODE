# 偏最小二乘回归分析概述

_在实际问题中，经常遇到需要研究**两组多重相关变量间的相互依赖关系**，并研究**用一组变量（预测变量）去预测另一组变量（响应变量）**，除了最小二乘准则下的 **经典多元线性回归分析（MLR)** ,提取自变量组主成分的**主成分回归分析（PCR）**,还有近年发展起来的**偏最小二乘（PLS）回归方法**_

---

$考虑p个因变量y_1,y_2,\dots,y_p与m个自变量x_1,x_2,\dots,x_m的建模问题。$

## 基本做法

1. $在自变量集中提出第一成分u_1(u_1是 x_1,\dots,x_m的线性组合，且可能多地提取原自变量集中的变异信息);$$同时在因变量集中也提取第一成分v_1,并要求u_1与v_1相关程度达到最高。$
2. $然后建立因变量y_1,\dots,y_p 与 u_1的回归,如果回归方程已达到满意的精度,则算法终止;$
   $否则，继续第二队成分的提取，直到达到满意的精度为止。$
3. $若最终对自变量集提取r个成分u_1,u_2,\dots,u_r,偏最小二乘回归将通过建立y_1,\dots,y_n与u_1,\dots,u_r的回归式，$
   $然后再表示为y_1,\dots,y_p 与原自变量的回归方程式，即偏最小二乘回归方程式$

## 具体步骤

$假定p个因变量y_1,\dots,y_p与m个自变量x_1,\dots,x_m均为标准化变量。自变量组与因变量组的n次标准化观测矩阵分别记为$

$$
A=\begin{bmatrix}
{a_{11}}&{\cdots}&{a_{1m}}\\
{a_{21}}&{\cdots}&{a_{2m}}\\
{\vdots}&{\ddots}&{\vdots}\\
{a_{n1}}&{\cdots}&{a_{nm}}\\
\end{bmatrix}
,
B=\begin{bmatrix}
{b_{11}}&{\cdots}&{b_{1m}}\\
{b_{21}}&{\cdots}&{b_{2m}}\\
{\vdots}&{\ddots}&{\vdots}\\
{b_{n1}}&{\cdots}&{b_{nm}}\\
\end{bmatrix}
$$

1. 分别提取两变量组的第一对成分，并使之相关性达到最大。
2. 建立$y_1,\dots,y_p$对 $u_1$的回归及$x1,\dots,x_m$ 的回归。
3. 用残差阵$A_1和$$B_1$代替$A和B$，重复以上步骤。
4. 设$n*m数据阵A$的秩为$r \leq \min(n-1,m)$，则存在r个成分$u_1,u_2,\dots,u_r$，使得

$$
\left\{
   \begin{array}{rcl}
   A= \hat{u_1}\sigma^{(1)T}+\dots+\hat{u_r}\sigma^{(r)T}+A_r   \\
   B= \hat{u_1}\gamma^{(1)T}+\dots+\hat{u_r}\gamma^{(r)T}+B_r \\
   \end{array} \right.
$$

    把$u_k=a_{k1}x_1+\dots+a_{km}x_{m}(k=1,2,\dots,r)$，代入$Y=u_1\gamma^{(1)}+\dots+u_r\gamma^{(r)}$，即得p个因变量的偏最小二乘回归方程式为

$$
y_j=c_{j1}x_1+\dots+c_{jm}x_m,j=1,2,\dots,p
$$

5. 交叉有效性检验

# Matlab偏最小二乘回归命令

`[XL,YL,XS,YS,BETA,PCTVAR,MSE,stats]=plsregress(X,Y,ncomp)`

- **X**   自变量矩阵，大小为n*p（行向量为样本，列向量为变量）。
- **Y**   因变量矩阵，大小为n*m。
- **XL**  为自变量的载荷矩阵，大小为p*ncomp维，每行为PLS主成分对原始自变量近似的线性组合系数。
- **YL**  为因变量的载荷矩阵，大小为m*ncomp维,，每行为PLS主成分对原始因变量近似的线性组合系数。
- **XS**  n*ncomp维正交矩阵，自变量得分矩阵（X中的原始变量对PLS主成分的线性组合），行向量为样本，列向量为主成分。
- **YS**  n*ncomp维矩阵，因变量得分矩阵（与XS的主成分具有最大协方差的因变量的线性组合），行向量为样本，列向量为主成分。YS既不是正交也不是规范化的。
- **BATE** 为回归模型的系数
- **PCTVAR** 是一个两行的矩阵，第一行为自变量提取成分的贡献率，第二行为因变量提取成分的贡献率
- **MSE**  是一个两行的矩阵，第一行的第j个元素表示自变量与它的前j-1个提出成份之间回归方程的剩余标准差；第二行的第j个元素对应着因变量与它的前j-1个提出成份之间回归方程的剩余标准差；
- **stats** 返回4个值
  - stats.W   是一个pls权重的ρ_ncomp的矩阵，使XS=X0_W,每一列对应特征向量ρi
  - stats.T2   是XS每一点的T^2统计值
  - stats.Xresiduals 为预测值残差，X0-XS*XL'
  - stats.Yresiduals 为响应残差，Y0-XS*YL'
